/*!
 * Copyright (C) 2007-2015 eBay Inc. All Rights Reserved.
 */
var RefineContainer = {
    _SORT_LISTS: {},
    _FILTER_LISTS: {},
    _currentListType: null,
    init: function () {
        this._SORT_LISTS[Item.TYPES.WATCHING] =
            { entries: [
                    { label: "refine.sortBy.timeEndingSoonest",
                        key: TradingApi.SORT.END_TIME },
                    { label: "refine.sortBy.priceLowest",
                        key: TradingApi.SORT.CURRENT_PRICE },
                    { label: "refine.sortBy.priceHighest",
                        key: TradingApi.SORT.CURRENT_PRICE_DESC }
                ], defaultKey: TradingApi.SORT.END_TIME };
        this._SORT_LISTS[Item.TYPES.BEST_OFFER] =
            { entries: [
                    { label: "refine.sortBy.offerStatus",
                        key: TradingApi.SORT.BEST_OFFER },
                    { label: "refine.sortBy.timeEndingSoonest",
                        key: TradingApi.SORT.END_TIME },
                    { label: "refine.sortBy.priceLowest",
                        key: TradingApi.SORT.CURRENT_PRICE },
                    { label: "refine.sortBy.priceHighest",
                        key: TradingApi.SORT.CURRENT_PRICE_DESC }
                ], defaultKey: TradingApi.SORT.END_TIME };
        this._SORT_LISTS[Item.TYPES.LOST] =
            { entries: [
                    { label: "refine.sortBy.timeEndedRecentFirst",
                        key: TradingApi.SORT.END_TIME_DESC },
                    { label: "refine.sortBy.timeEndedRecentLast",
                        key: TradingApi.SORT.END_TIME },
                    { label: "refine.sortBy.priceLowest",
                        key: TradingApi.SORT.CURRENT_PRICE },
                    { label: "refine.sortBy.priceHighest",
                        key: TradingApi.SORT.CURRENT_PRICE_DESC }
                ], defaultKey: TradingApi.SORT.END_TIME_DESC };
        this._SORT_LISTS[Item.TYPES.SELLING] =
            { entries: [
                    { label: "refine.sortBy.timeLeftEndingSoonest",
                        key: TradingApi.SORT.END_TIME },
                    { label: "refine.sortBy.timeLeftNewlyListed",
                        key: TradingApi.SORT.START_TIME_DESC },
                    { label: "refine.sortBy.priceLowest",
                        key: TradingApi.SORT.CURRENT_PRICE },
                    { label: "refine.sortBy.priceHighest",
                        key: TradingApi.SORT.CURRENT_PRICE_DESC },
                    { label: "refine.sortBy.watchersLowest",
                        key: TradingApi.SORT.WATCH_COUNT },
                    { label: "refine.sortBy.watchersHighest",
                        key: TradingApi.SORT.WATCH_COUNT_DESC }
                ], defaultKey: TradingApi.SORT.END_TIME };
        this._SORT_LISTS[Item.TYPES.SOLD] =
            { entries: [
                    { label: "refine.sortBy.timeEndedRecentFirst",
                        key: TradingApi.SORT.END_TIME_DESC },
                    { label: "refine.sortBy.timeEndedRecentLast",
                        key: TradingApi.SORT.END_TIME },
                    { label: "refine.sortBy.priceLowest",
                        key: TradingApi.SORT.CURRENT_PRICE },
                    { label: "refine.sortBy.priceHighest",
                        key: TradingApi.SORT.CURRENT_PRICE_DESC }
                ], defaultKey: TradingApi.SORT.END_TIME_DESC };
        this._SORT_LISTS[Item.TYPES.UNSOLD] =
            { entries: [
                    { label: "refine.sortBy.timeEndedRecentFirst",
                        key: TradingApi.SORT.END_TIME_DESC },
                    { label: "refine.sortBy.timeEndedRecentLast",
                        key: TradingApi.SORT.END_TIME }
                ], defaultKey: TradingApi.SORT.END_TIME_DESC };
        this._FILTER_LISTS[Item.TYPES.SOLD] =
            { entries: [
                    { label: "refine.filterBy.all",
                        key: MyEbayService.FILTER.ALL },
                    { label: "refine.filterBy.notPaid",
                        key: MyEbayService.FILTER.AWAITING_PAYMENT },
                    { label: "refine.filterBy.awaitingShipment",
                        key: MyEbayService.FILTER.AWAITING_SHIPMENT },
                    { label: "refine.filterBy.shipped",
                        key: MyEbayService.FILTER.PAID_AND_SHIPPED }
                ], defaultKey: MyEbayService.FILTER.ALL };
        this._addEventListeners();
        Sidebar.styleScroll("refine-main");
    },
    uninit: function () {
    },
    _addEventListeners: function () {
        $("#refine-cancel").click(function (aEvent) {
            aEvent.preventDefault();
            var eventLabel = Sidebar.getGAListTypeTrackingName(this._currentListType);
            EventAnalytics.push({
                key: "SignedInInternal",
                action: "ClickRefineCancel",
                label: eventLabel
            });
            this.hide();
            SearchBox.showSearchContent(false);
        }.bind(this));
        $("#refine-apply").click(function () {
            var eventLabel = Sidebar.getGAListTypeTrackingName(this._currentListType);
            EventAnalytics.push({
                key: "SignedInInternal",
                action: "ClickRefineApply",
                label: eventLabel
            });
            Sidebar.scrollToTop("panels");
            this._apply();
            this.hide();
        }.bind(this));
        $("#refine-reset").click(function () {
            var eventLabel = Sidebar.getGAListTypeTrackingName(this._currentListType);
            EventAnalytics.push({
                key: "SignedInInternal",
                action: "ClickRefineReset",
                label: eventLabel
            });
            Sidebar.scrollToTop("panels");
            this._reset();
            this.hide();
        }.bind(this));
        setTimeout(function () {
            $(".item-list-edit, .item-list-refine").click(function (aEvent) {
                $("#search-textbox").attr("tabindex", "-1");
            }.bind(this));
            $(".item-list-edit-cancel, #refine-cancel").click(function (aEvent) {
                $("#search-textbox").attr("tabindex", "0");
                $(".tab-item.active").focus();
            }.bind(this));
        }, 1000);
    },
    _createItem: function (aEntryObject, aSelected, aExtraInfo) {
        var checkedClass = aSelected ? 'checked="checked"' : "";
        var disabledClass = "";
        var countText = "";
        if (aExtraInfo && "count" in aExtraInfo) {
            countText = " (" + aExtraInfo.count + ")";
            if (aExtraInfo.count === 0 && aEntryObject.key != MyEbayService.FILTER.ALL) {
                disabledClass = 'disabled="true"';
            }
        }
        var refineType = (aExtraInfo && "refineType" in aExtraInfo) ? aExtraInfo.refineType : "";
        var boxLabel = $.i18n.getString(aEntryObject.label) + countText;
        var boxLabelForHTML = boxLabel.replace(/ /ig, '-');
        var boxString = '<div class="refine-item-container">' +
            '<div class="refine-item">' +
            '<label for="' + boxLabelForHTML + '" class="refine-item-title">' +
            '<input id="' + boxLabelForHTML + '" type="radio" name="' + refineType + '" value="' +
            boxLabelForHTML + '" class="refine-item-radio" ' + checkedClass + ' ' + disabledClass + ' />' +
            '<span>' + boxLabel + '</span>' +
            '</label>' +
            '</div>' +
            '</div>';
        var box = $(boxString);
        box.data("entryObject", { key: aEntryObject.key });
        return box;
    },
    _updatePanel: function (aType) {
        this._currentListType = aType;
        var refineKeys = this._getRefineKeys();
        var list;
        var entries;
        var defaultKey;
        var storedKey;
        var selectedKey;
        var i;
        var sortHeader = $(".refine-sort-by-header");
        var container = $("#refine-sort-by-list");
        container.empty();
        if (aType in this._SORT_LISTS) {
            list = this._SORT_LISTS[aType];
            entries = list.entries;
            defaultKey = list.defaultKey;
            storedKey = refineKeys.sort;
            selectedKey = storedKey ? storedKey : defaultKey;
            for (i = 0; i < entries.length; i++) {
                container.append(this._createItem(entries[i], entries[i].key == selectedKey, { refineType: "refine-sort" }));
            }
            sortHeader.show();
        }
        else {
            sortHeader.hide();
        }
        var filterHeader = $(".refine-filter-by-header");
        container = $("#refine-filter-by-list");
        container.empty();
        if (aType in this._FILTER_LISTS) {
            list = this._FILTER_LISTS[aType];
            entries = list.entries;
            defaultKey = list.defaultKey;
            storedKey = refineKeys.filter;
            selectedKey = storedKey ? storedKey : defaultKey;
            var summary;
            for (i = 0; i < entries.length; i++) {
                summary = MyEbayService.getFilterSummary(entries[i].key);
                container.append(this._createItem(entries[i], entries[i].key == selectedKey, { count: summary.count, refineType: "refine-filter" }));
            }
            filterHeader.show();
        }
        else {
            filterHeader.hide();
        }
    },
    show: function (aType) {
        this._updatePanel(aType);
        $("#refine-content").slideDown("fast");
        setTimeout(function () { Sidebar.hideOnlineOfflineContainers(); }, 300);
    },
    hide: function () {
        $("#refine-content").slideUp("fast");
        Sidebar.setOnlineState();
        PanelContainer.resetDockHeader();
    },
    _getRefineKeys: function () {
        var keys = {};
        var listName;
        switch (this._currentListType) {
            case Item.TYPES.WATCHING:
                listName = TradingApi.WATCH_LIST;
                break;
            case Item.TYPES.BIDDING:
                listName = TradingApi.BID_LIST;
                break;
            case Item.TYPES.WON:
                listName = TradingApi.WON_LIST;
                break;
            case Item.TYPES.LOST:
                listName = TradingApi.LOST_LIST;
                break;
            case Item.TYPES.BEST_OFFER:
                listName = TradingApi.BEST_OFFER_LIST;
                break;
            case Item.TYPES.SELLING:
                listName = TradingApi.ACTIVE_LIST;
                break;
            case Item.TYPES.SOLD:
                listName = TradingApi.SOLD_LIST;
                break;
            case Item.TYPES.UNSOLD:
                listName = TradingApi.UNSOLD_LIST;
                break;
            case Item.TYPES.SCHEDULED:
                listName = TradingApi.SCHEDULED_LIST;
                break;
        }
        if (listName) {
            keys = MyEbayService.getRefine(listName);
        }
        return keys;
    },
    _applyRefineKeys: function (aObject) {
        var listName;
        switch (this._currentListType) {
            case Item.TYPES.WATCHING:
                listName = TradingApi.WATCH_LIST;
                MyEbayService.setRefine(listName, aObject);
                MyEbayService.loadBuyingListData({
                    name: listName
                });
                break;
            case Item.TYPES.WON:
                listName = TradingApi.WON_LIST;
                MyEbayService.setRefine(listName, aObject);
                MyEbayService.loadBuyingListData({
                    name: listName,
                    entriesPerPage: MyEbayService.LIST_ITEM_BATCH_SIZE
                });
                break;
            case Item.TYPES.LOST:
                listName = TradingApi.LOST_LIST;
                MyEbayService.setRefine(listName, aObject);
                MyEbayService.loadBuyingListData({
                    name: listName,
                    entriesPerPage: MyEbayService.LIST_ITEM_BATCH_SIZE
                });
                break;
            case Item.TYPES.BEST_OFFER:
                listName = TradingApi.BEST_OFFER_LIST;
                MyEbayService.setRefine(listName, aObject);
                MyEbayService.loadBuyingListData({
                    name: listName,
                    entriesPerPage: MyEbayService.LIST_ITEM_BATCH_SIZE
                });
                break;
            case Item.TYPES.SELLING:
                listName = TradingApi.ACTIVE_LIST;
                MyEbayService.setRefine(listName, aObject);
                MyEbayService.loadSellingListData({
                    name: listName,
                    entriesPerPage: MyEbayService.LIST_ITEM_BATCH_SIZE
                });
                break;
            case Item.TYPES.SOLD:
                listName = TradingApi.SOLD_LIST;
                MyEbayService.setRefine(listName, aObject);
                MyEbayService.loadSellingListData({
                    name: listName,
                    entriesPerPage: MyEbayService.LIST_ITEM_BATCH_SIZE
                });
                break;
            case Item.TYPES.UNSOLD:
                listName = TradingApi.UNSOLD_LIST;
                MyEbayService.setRefine(listName, aObject);
                MyEbayService.loadSellingListData({
                    name: listName,
                    entriesPerPage: MyEbayService.LIST_ITEM_BATCH_SIZE
                });
                break;
        }
    },
    _apply: function () {
        var applyObj = {};
        var parents = null;
        var key = null;
        var sortKeyElement = $("#refine-sort-by-list input[type='radio']:checked");
        if (0 < sortKeyElement.length) {
            parents = $(sortKeyElement).parents(".refine-item-container");
            if (0 < parents.length) {
                key = $(parents[0]).data("entryObject").key;
                if (key) {
                    applyObj.sort = key;
                }
            }
        }
        parent = null;
        key = null;
        var filterKeyElement = $("#refine-filter-by-list input[type='radio']:checked");
        if (0 < filterKeyElement.length) {
            parents = $(filterKeyElement).parents(".refine-item-container");
            if (0 < parents.length) {
                key = $(parents[0]).data("entryObject").key;
                if (key) {
                    applyObj.filter = key;
                }
            }
        }
        this._applyRefineKeys(applyObj);
    },
    _reset: function () {
        this._applyRefineKeys({ sort: null, filter: null });
    }
};
$(window).unload(function () { RefineContainer.uninit(); });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVmaW5lQ29udGFpbmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vdWkvdmlldy9jb3JlL3JlZmluZUNvbnRhaW5lci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7R0FFRztBQUVILElBQUksZUFBZSxHQUFHO0lBRXBCLFdBQVcsRUFBRSxFQUFFO0lBQ2YsYUFBYSxFQUFFLEVBQUU7SUFDakIsZ0JBQWdCLEVBQUcsSUFBSTtJQUV2QixJQUFJLEVBQUc7UUFDTCxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDO1lBQ25DLEVBQUUsT0FBTyxFQUFFO29CQUNULEVBQUUsS0FBSyxFQUFFLGlDQUFpQzt3QkFDeEMsR0FBRyxFQUFFLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFO29CQUNqQyxFQUFFLEtBQUssRUFBRSwyQkFBMkI7d0JBQ2xDLEdBQUcsRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRTtvQkFDdEMsRUFBRSxLQUFLLEVBQUUsNEJBQTRCO3dCQUNuQyxHQUFHLEVBQUUsVUFBVSxDQUFDLElBQUksQ0FBQyxrQkFBa0IsRUFBRTtpQkFDNUMsRUFBRSxVQUFVLEVBQUUsVUFBVSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztRQUU1QyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsVUFBVSxDQUFDO1lBQ3JDLEVBQUUsT0FBTyxFQUFFO29CQUNULEVBQUUsS0FBSyxFQUFFLDJCQUEyQjt3QkFDbEMsR0FBRyxFQUFFLFVBQVUsQ0FBQyxJQUFJLENBQUMsVUFBVSxFQUFFO29CQUNuQyxFQUFFLEtBQUssRUFBRSxpQ0FBaUM7d0JBQ3hDLEdBQUcsRUFBRSxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRTtvQkFDakMsRUFBRSxLQUFLLEVBQUUsMkJBQTJCO3dCQUNsQyxHQUFHLEVBQUUsVUFBVSxDQUFDLElBQUks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UUFDWCxJQUFJLGdCQUFnQixHQUFHLENBQUMsQ0FBQyxvREFBb0QsQ0FBQyxDQUFDO1FBQy9FLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxnQkFBZ0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO1lBQ2hDLE9BQU8sR0FBRyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxPQUFPLENBQUMsd0JBQXdCLENBQUMsQ0FBQztZQUVoRSxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUM7Z0JBQ3ZCLEdBQUcsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUFDLEdBQUcsQ0FBQztnQkFDNUMsRUFBRSxDQUFDLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQztvQkFDUixRQUFRLENBQUMsTUFBTSxHQUFHLEdBQUcsQ0FBQztnQkFDeEIsQ0FBQztZQUNILENBQUM7UUFDSCxDQUFDO1FBRUQsSUFBSSxDQUFDLGdCQUFnQixDQUFDLFFBQVEsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxNQUFNLEVBQUc7UUFDUCxJQUFJLENBQUMsZ0JBQWdCLENBQUMsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDO0lBQ3RELENBQUM7Q0FDRixDQUFDO0FBRUYsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFDLE1BQU0sQ0FBQyxjQUFhLGVBQWUsQ0FBQyxNQUFNLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLyohXG4gKiBDb3B5cmlnaHQgKEMpIDIwMDctMjAxNSBlQmF5IEluYy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC5cbiAqL1xuXG52YXIgUmVmaW5lQ29udGFpbmVyID0ge1xuXG4gIF9TT1JUX0xJU1RTOiB7fSxcbiAgX0ZJTFRFUl9MSVNUUzoge30sXG4gIF9jdXJyZW50TGlzdFR5cGUgOiBudWxsLFxuXG4gIGluaXQgOiBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9TT1JUX0xJU1RTW0l0ZW0uVFlQRVMuV0FUQ0hJTkddID1cbiAgICAgIHsgZW50cmllczogW1xuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0QnkudGltZUVuZGluZ1Nvb25lc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5FTkRfVElNRSB9LFxuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0QnkucHJpY2VMb3dlc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5DVVJSRU5UX1BSSUNFIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS5wcmljZUhpZ2hlc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5DVVJSRU5UX1BSSUNFX0RFU0MgfVxuICAgICAgXSwgZGVmYXVsdEtleTogVHJhZGluZ0FwaS5TT1JULkVORF9USU1FIH07XG4gICAgLy8gYnV5aW5nXG4gICAgdGhpcy5fU09SVF9MSVNUU1tJdGVtLlRZUEVTLkJFU1RfT0ZGRVJdID1cbiAgICAgIHsgZW50cmllczogW1xuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0Qnkub2ZmZXJTdGF0dXNcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5CRVNUX09GRkVSIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS50aW1lRW5kaW5nU29vbmVzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULkVORF9USU1FIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS5wcmljZUxvd2VzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULkNVUlJFTlRfUFJJQ0UgfSxcbiAgICAgICAgeyBsYWJlbDogXCJyZWZpbmUuc29ydEJ5LnByaWNlSGlnaGVzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULkNVUlJFTlRfUFJJQ0VfREVTQyB9XG4gICAgICBdLCBkZWZhdWx0S2V5OiBUcmFkaW5nQXBpLlNPUlQuRU5EX1RJTUUgfTtcbiAgICB0aGlzLl9TT1JUX0xJU1RTW0l0ZW0uVFlQRVMuTE9TVF0gPVxuICAgICAgeyBlbnRyaWVzOiBbXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS50aW1lRW5kZWRSZWNlbnRGaXJzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULkVORF9USU1FX0RFU0MgfSxcbiAgICAgICAgeyBsYWJlbDogXCJyZWZpbmUuc29ydEJ5LnRpbWVFbmRlZFJlY2VudExhc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5FTkRfVElNRSB9LFxuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0QnkucHJpY2VMb3dlc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5DVVJSRU5UX1BSSUNFIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS5wcmljZUhpZ2hlc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5DVVJSRU5UX1BSSUNFX0RFU0MgfVxuICAgICAgXSwgZGVmYXVsdEtleTogVHJhZGluZ0FwaS5TT1JULkVORF9USU1FX0RFU0MgfTtcbiAgICAvLyBzZWxsaW5nXG4gICAgdGhpcy5fU09SVF9MSVNUU1tJdGVtLlRZUEVTLlNFTExJTkddID1cbiAgICAgIHsgZW50cmllczogW1xuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0QnkudGltZUxlZnRFbmRpbmdTb29uZXN0XCIsXG4gICAgICAgICAga2V5OiBUcmFkaW5nQXBpLlNPUlQuRU5EX1RJTUUgfSxcbiAgICAgICAgeyBsYWJlbDogXCJyZWZpbmUuc29ydEJ5LnRpbWVMZWZ0TmV3bHlMaXN0ZWRcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5TVEFSVF9USU1FX0RFU0MgfSxcbiAgICAgICAgeyBsYWJlbDogXCJyZWZpbmUuc29ydEJ5LnByaWNlTG93ZXN0XCIsXG4gICAgICAgICAga2V5OiBUcmFkaW5nQXBpLlNPUlQuQ1VSUkVOVF9QUklDRSB9LFxuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0QnkucHJpY2VIaWdoZXN0XCIsXG4gICAgICAgICAga2V5OiBUcmFkaW5nQXBpLlNPUlQuQ1VSUkVOVF9QUklDRV9ERVNDIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS53YXRjaGVyc0xvd2VzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULldBVENIX0NPVU5UIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS53YXRjaGVyc0hpZ2hlc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5XQVRDSF9DT1VOVF9ERVNDIH1cbiAgICAgIF0sIGRlZmF1bHRLZXk6IFRyYWRpbmdBcGkuU09SVC5FTkRfVElNRSB9O1xuICAgIHRoaXMuX1NPUlRfTElTVFNbSXRlbS5UWVBFUy5TT0xEXSA9XG4gICAgICB7IGVudHJpZXM6IFtcbiAgICAgICAgeyBsYWJlbDogXCJyZWZpbmUuc29ydEJ5LnRpbWVFbmRlZFJlY2VudEZpcnN0XCIsXG4gICAgICAgICAga2V5OiBUcmFkaW5nQXBpLlNPUlQuRU5EX1RJTUVfREVTQyB9LFxuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0QnkudGltZUVuZGVkUmVjZW50TGFzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULkVORF9USU1FIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS5wcmljZUxvd2VzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULkNVUlJFTlRfUFJJQ0UgfSxcbiAgICAgICAgeyBsYWJlbDogXCJyZWZpbmUuc29ydEJ5LnByaWNlSGlnaGVzdFwiLFxuICAgICAgICAgIGtleTogVHJhZGluZ0FwaS5TT1JULkNVUlJFTlRfUFJJQ0VfREVTQyB9XG4gICAgICBdLCBkZWZhdWx0S2V5OiBUcmFkaW5nQXBpLlNPUlQuRU5EX1RJTUVfREVTQyB9O1xuICAgIHRoaXMuX1NPUlRfTElTVFNbSXRlbS5UWVBFUy5VTlNPTERdID1cbiAgICAgIHsgZW50cmllczogW1xuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5zb3J0QnkudGltZUVuZGVkUmVjZW50Rmlyc3RcIixcbiAgICAgICAgICBrZXk6IFRyYWRpbmdBcGkuU09SVC5FTkRfVElNRV9ERVNDIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLnNvcnRCeS50aW1lRW5kZWRSZWNlbnRMYXN0XCIsXG4gICAgICAgICAga2V5OiBUcmFkaW5nQXBpLlNPUlQuRU5EX1RJTUUgfVxuICAgICAgXSwgZGVmYXVsdEtleTogVHJhZGluZ0FwaS5TT1JULkVORF9USU1FX0RFU0MgfTtcblxuICAgIHRoaXMuX0ZJTFRFUl9MSVNUU1tJdGVtLlRZUEVTLlNPTERdID1cbiAgICAgIHsgZW50cmllczogW1xuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5maWx0ZXJCeS5hbGxcIixcbiAgICAgICAgICBrZXk6IE15RWJheVNlcnZpY2UuRklMVEVSLkFMTCB9LFxuICAgICAgICB7IGxhYmVsOiBcInJlZmluZS5maWx0ZXJCeS5ub3RQYWlkXCIsXG4gICAgICAgICAga2V5OiBNeUViYXlTZXJ2aWNlLkZJTFRFUi5BV0FJVElOR19QQVlNRU5UIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLmZpbHRlckJ5LmF3YWl0aW5nU2hpcG1lbnRcIixcbiAgICAgICAgICBrZXk6IE15RWJheVNlcnZpY2UuRklMVEVSLkFXQUlUSU5HX1NISVBNRU5UIH0sXG4gICAgICAgIHsgbGFiZWw6IFwicmVmaW5lLmZpbHRlckJ5LnNoaXBwZWRcIixcbiAgICAgICAgICBrZXk6IE15RWJheVNlcnZpY2UuRklMVEVSLlBBSURfQU5EX1NISVBQRUQgfVxuICAgICAgXSwgZGVmYXVsdEtleTogTXlFYmF5U2VydmljZS5GSUxURVIuQUxMIH07XG5cbiAgICB0aGlzLl9hZGRFdmVudExpc3RlbmVycygpO1xuICAgIFNpZGViYXIuc3R5bGVTY3JvbGwoXCJyZWZpbmUtbWFpblwiKTtcbiAgfSxcblxuICB1bmluaXQgOiBmdW5jdGlvbigpIHtcbiAgfSxcblxuICBfYWRkRXZlbnRMaXN0ZW5lcnMgOiBmdW5jdGlvbigpIHtcbiAgICAkKFwiI3JlZmluZS1jYW5jZWxcIikuY2xpY2soZnVuY3Rpb24oYUV2ZW50KSB7XG4gICAgICAvLyBQcmV2ZW50IFNhZmFyaSBmcm9tIHNlbmRpbmcgZGVmYXVsdCByZXF1ZXN0cyBvbiBpdGVtIGNsaWNrLlxuICAgICAgYUV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB2YXIgZXZlbnRMYWJlbCA9IFNpZGViYXIuZ2V0R0FMaXN0VHlwZVRyYWNraW5nTmFtZSh0aGlzLl9jdXJyZW50TGlzdFR5cGUpO1xuICAgICAgRXZlbnRBbmFseXRpY3MucHVzaCh7XG4gICAgICAgIGtleTogXCJTaWduZWRJbkludGVybmFsXCIsXG4gICAgICAgIGFjdGlvbjogXCJDbGlja1JlZmluZUNhbmNlbFwiLFxuICAgICAgICBsYWJlbDogZXZlbnRMYWJlbFxuICAgICAgfSk7XG4gICAgICB0aGlzLmhpZGUoKTtcbiAgICAgIFNlYXJjaEJveC5zaG93U2VhcmNoQ29udGVudChmYWxzZSk7XG4gICAgfS5iaW5kKHRoaXMpKTtcbiAgICAkKFwiI3JlZmluZS1hcHBseVwiKS5jbGljayhmdW5jdGlvbigpIHtcbiAgICAgIHZhciBldmVudExhYmVsID0gU2lkZWJhci5nZXRHQUxpc3RUeXBlVHJhY2tpbmdOYW1lKHRoaXMuX2N1cnJlbnRMaXN0VHlwZSk7XG4gICAgICBFdmVudEFuYWx5dGljcy5wdXNoKHtcbiAgICAgICAga2V5OiBcIlNpZ25lZEluSW50ZXJuYWxcIixcbiAgICAgICAgYWN0aW9uOiBcIkNsaWNrUmVmaW5lQXBwbHlcIixcbiAgICAgICAgbGFiZWw6IGV2ZW50TGFiZWxcbiAgICAgIH0pO1xuICAgICAgU2lkZWJhci5zY3JvbGxUb1RvcChcInBhbmVsc1wiKTtcbiAgICAgIHRoaXMuX2FwcGx5KCk7XG4gICAgICB0aGlzLmhpZGUoKTtcbiAgICB9LmJpbmQodGhpcykpO1xuICAgICQoXCIjcmVmaW5lLXJlc2V0XCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIGV2ZW50TGFiZWwgPSBTaWRlYmFyLmdldEdBTGlzdFR5cGVUcmFja2luZ05hbWUodGhpcy5fY3VycmVudExpc3RUeXBlKTtcbiAgICAgIEV2ZW50QW5hbHl0aWNzLnB1c2goe1xuICAgICAgICBrZXk6IFwiU2lnbmVkSW5JbnRlcm5hbFwiLFxuICAgICAgICBhY3Rpb246IFwiQ2xpY2tSZWZpbmVSZXNldFwiLFxuICAgICAgICBsYWJlbDogZXZlbnRMYWJlbFxuICAgICAgfSk7XG4gICAgICBTaWRlYmFyLnNjcm9sbFRvVG9wKFwicGFuZWxzXCIpO1xuICAgICAgdGhpcy5fcmVzZXQoKTtcbiAgICAgIHRoaXMuaGlkZSgpO1xuICAgIH0uYmluZCh0aGlzKSk7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgJChcIi5pdGVtLWxpc3QtZWRpdCwgLml0ZW0tbGlzdC1yZWZpbmVcIikuY2xpY2soZnVuY3Rpb24oYUV2ZW50KSB7XG4gICAgICAgICQoXCIjc2VhcmNoLXRleHRib3hcIikuYXR0cihcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgICAgJChcIi5pdGVtLWxpc3QtZWRpdC1jYW5jZWwsICNyZWZpbmUtY2FuY2VsXCIpLmNsaWNrKGZ1bmN0aW9uKGFFdmVudCkge1xuICAgICAgICAkKFwiI3NlYXJjaC10ZXh0Ym94XCIpLmF0dHIoXCJ0YWJpbmRleFwiLCBcIjBcIik7XG4gICAgICAgICQoXCIudGFiLWl0ZW0uYWN0aXZlXCIpLmZvY3VzKCk7XG4gICAgICB9LmJpbmQodGhpcykpO1xuICAgIH0sIDEwMDApO1xuICB9LFxuXG4gIF9jcmVhdGVJdGVtIDogZnVuY3Rpb24oYUVudHJ5T2JqZWN0LCBhU2VsZWN0ZWQsIGFFeHRyYUluZm8pIHtcbiAgICB2YXIgY2hlY2tlZENsYXNzID0gYVNlbGVjdGVkID8gJ2NoZWNrZWQ9XCJjaGVja2VkXCInIDogXCJcIjtcbiAgICB2YXIgZGlzYWJsZWRDbGFzcyA9IFwiXCI7XG4gICAgdmFyIGNvdW50VGV4dCA9IFwiXCI7XG4gICAgaWYgKGFFeHRyYUluZm8gJiYgXCJjb3VudFwiIGluIGFFeHRyYUluZm8pIHtcbiAgICAgIGNvdW50VGV4dCA9IFwiIChcIiArIGFFeHRyYUluZm8uY291bnQgKyBcIilcIjtcbiAgICAgIGlmIChhRXh0cmFJbmZvLmNvdW50ID09PSAwICYmIGFFbnRyeU9iamVjdC5rZXkgIT0gTXlFYmF5U2VydmljZS5GSUxURVIuQUxMKSB7XG4gICAgICAgIGRpc2FibGVkQ2xhc3MgPSAnZGlzYWJsZWQ9XCJ0cnVlXCInO1xuICAgICAgfVxuICAgIH1cbiAgICB2YXIgcmVmaW5lVHlwZSA9IChhRXh0cmFJbmZvICYmIFwicmVmaW5lVHlwZVwiIGluIGFFeHRyYUluZm8pID8gYUV4dHJhSW5mby5yZWZpbmVUeXBlIDogXCJcIjtcblxuICAgIHZhciBib3hMYWJlbCA9ICQuaTE4bi5nZXRTdHJpbmcoYUVudHJ5T2JqZWN0LmxhYmVsKSArIGNvdW50VGV4dDtcbiAgICB2YXIgYm94TGFiZWxGb3JIVE1MID0gYm94TGFiZWwucmVwbGFjZSgvIC9pZywgJy0nKTtcbiAgICB2YXIgYm94U3RyaW5nID1cbiAgICAnPGRpdiBjbGFzcz1cInJlZmluZS1pdGVtLWNvbnRhaW5lclwiPicgK1xuICAgICAgJzxkaXYgY2xhc3M9XCJyZWZpbmUtaXRlbVwiPicgK1xuICAgICAgICAnPGxhYmVsIGZvcj1cIicgKyBib3hMYWJlbEZvckhUTUwgKyAnXCIgY2xhc3M9XCJyZWZpbmUtaXRlbS10aXRsZVwiPicgK1xuICAgICAgICAgICc8aW5wdXQgaWQ9XCInICsgYm94TGFiZWxGb3JIVE1MICsgJ1wiIHR5cGU9XCJyYWRpb1wiIG5hbWU9XCInICsgcmVmaW5lVHlwZSArICdcIiB2YWx1ZT1cIicgK1xuICAgICAgICAgICAgYm94TGFiZWxGb3JIVE1MICsgJ1wiIGNsYXNzPVwicmVmaW5lLWl0ZW0tcmFkaW9cIiAnICsgY2hlY2tlZENsYXNzICsgJyAnICArIGRpc2FibGVkQ2xhc3MgKyAnIC8+JyArXG4gICAgICAgICAgJzxzcGFuPicgKyBib3hMYWJlbCArICc8L3NwYW4+JyArXG4gICAgICAgICc8L2xhYmVsPicgK1xuICAgICAgJzwvZGl2PicgK1xuICAgICc8L2Rpdj4nO1xuXG4gICAgdmFyIGJveCA9ICQoYm94U3RyaW5nKTtcbiAgICBib3guZGF0YShcImVudHJ5T2JqZWN0XCIsIHsga2V5OiBhRW50cnlPYmplY3Qua2V5IH0pO1xuXG4gICAgcmV0dXJuIGJveDtcbiAgfSxcblxuICBfdXBkYXRlUGFuZWwgOiBmdW5jdGlvbihhVHlwZSkge1xuICAgIHRoaXMuX2N1cnJlbnRMaXN0VHlwZSA9IGFUeXBlO1xuICAgIHZhciByZWZpbmVLZXlzID0gdGhpcy5fZ2V0UmVmaW5lS2V5cygpO1xuICAgIHZhciBsaXN0O1xuICAgIHZhciBlbnRyaWVzO1xuICAgIHZhciBkZWZhdWx0S2V5O1xuICAgIHZhciBzdG9yZWRLZXk7XG4gICAgdmFyIHNlbGVjdGVkS2V5O1xuICAgIHZhciBpO1xuXG4gICAgdmFyIHNvcnRIZWFkZXIgPSAkKFwiLnJlZmluZS1zb3J0LWJ5LWhlYWRlclwiKTtcbiAgICB2YXIgY29udGFpbmVyID0gJChcIiNyZWZpbmUtc29ydC1ieS1saXN0XCIpO1xuICAgIGNvbnRhaW5lci5lbXB0eSgpO1xuICAgIGlmIChhVHlwZSBpbiB0aGlzLl9TT1JUX0xJU1RTKSB7XG4gICAgICBsaXN0ID0gdGhpcy5fU09SVF9MSVNUU1thVHlwZV07XG4gICAgICBlbnRyaWVzID0gbGlzdC5lbnRyaWVzO1xuICAgICAgZGVmYXVsdEtleSA9IGxpc3QuZGVmYXVsdEtleTtcbiAgICAgIHN0b3JlZEtleSA9IHJlZmluZUtleXMuc29ydDtcbiAgICAgIHNlbGVjdGVkS2V5ID0gc3RvcmVkS2V5ID8gc3RvcmVkS2V5IDogZGVmYXVsdEtleTtcblxuICAgICAgZm9yIChpID0gMDsgaSA8IGVudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgY29udGFpbmVyLmFwcGVuZCh0aGlzLl9jcmVhdGVJdGVtKGVudHJpZXNbaV0sIGVudHJpZXNbaV0ua2V5ID09IHNlbGVjdGVkS2V5LFxuICAgICAgICAgIHsgcmVmaW5lVHlwZTogXCJyZWZpbmUtc29ydFwiIH0pKTtcbiAgICAgIH1cbiAgICAgIHNvcnRIZWFkZXIuc2hvdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICBzb3J0SGVhZGVyLmhpZGUoKTtcbiAgICB9XG5cbiAgICB2YXIgZmlsdGVySGVhZGVyID0gJChcIi5yZWZpbmUtZmlsdGVyLWJ5LWhlYWRlclwiKTtcbiAgICBjb250YWluZXIgPSAkKFwiI3JlZmluZS1maWx0ZXItYnktbGlzdFwiKTtcbiAgICBjb250YWluZXIuZW1wdHkoKTtcbiAgICBpZiAoYVR5cGUgaW4gdGhpcy5fRklMVEVSX0xJU1RTKSB7XG4gICAgICBsaXN0ID0gdGhpcy5fRklMVEVSX0xJU1RTW2FUeXBlXTtcbiAgICAgIGVudHJpZXMgPSBsaXN0LmVudHJpZXM7XG4gICAgICBkZWZhdWx0S2V5ID0gbGlzdC5kZWZhdWx0S2V5O1xuICAgICAgc3RvcmVkS2V5ID0gcmVmaW5lS2V5cy5maWx0ZXI7XG4gICAgICBzZWxlY3RlZEtleSA9IHN0b3JlZEtleSA/IHN0b3JlZEtleSA6IGRlZmF1bHRLZXk7XG4gICAgICB2YXIgc3VtbWFyeTtcblxuICAgICAgZm9yIChpID0gMDsgaSA8IGVudHJpZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgc3VtbWFyeSA9IE15RWJheVNlcnZpY2UuZ2V0RmlsdGVyU3VtbWFyeShlbnRyaWVzW2ldLmtleSk7XG4gICAgICAgIGNvbnRhaW5lci5hcHBlbmQoXG4gICAgICAgICAgdGhpcy5fY3JlYXRlSXRlbShlbnRyaWVzW2ldLCBlbnRyaWVzW2ldLmtleSA9PSBzZWxlY3RlZEtleSxcbiAgICAgICAgICAgIHsgY291bnQ6IHN1bW1hcnkuY291bnQsIHJlZmluZVR5cGU6IFwicmVmaW5lLWZpbHRlclwiIH0pKTtcbiAgICAgIH1cbiAgICAgIGZpbHRlckhlYWRlci5zaG93KCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGZpbHRlckhlYWRlci5oaWRlKCk7XG4gICAgfVxuICB9LFxuXG4gIHNob3cgOiBmdW5jdGlvbihhVHlwZSkge1xuICAgIHRoaXMuX3VwZGF0ZVBhbmVsKGFUeXBlKTtcbiAgICAkKFwiI3JlZmluZS1jb250ZW50XCIpLnNsaWRlRG93bihcImZhc3RcIik7XG4gICAgLy8gWFhYOiBmb3IgdGhlIHJlZmluZSBjb250ZW50IHRvIGdldCB0aGUgZm9jdXMgZm9yIHRhYiBuYXZpZ2F0aW9uXG4gICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsgU2lkZWJhci5oaWRlT25saW5lT2ZmbGluZUNvbnRhaW5lcnMoKTsgfSwgMzAwKTtcbiAgfSxcblxuICBoaWRlIDogZnVuY3Rpb24oKSB7XG4gICAgJChcIiNyZWZpbmUtY29udGVudFwiKS5zbGlkZVVwKFwiZmFzdFwiKTtcbiAgICBTaWRlYmFyLnNldE9ubGluZVN0YXRlKCk7XG4gICAgUGFuZWxDb250YWluZXIucmVzZXREb2NrSGVhZGVyKCk7XG4gIH0sXG5cbiAgX2dldFJlZmluZUtleXMgOiBmdW5jdGlvbigpIHtcbiAgICB2YXIga2V5cyA9IHt9O1xuICAgIHZhciBsaXN0TmFtZTtcblxuICAgIHN3aXRjaCAodGhpcy5fY3VycmVudExpc3RUeXBlKSB7XG4gICAgICBjYXNlIEl0ZW0uVFlQRVMuV0FUQ0hJTkc6XG4gICAgICAgIGxpc3ROYW1lID0gVHJhZGluZ0FwaS5XQVRDSF9MSVNUO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5CSURESU5HOlxuICAgICAgICBsaXN0TmFtZSA9IFRyYWRpbmdBcGkuQklEX0xJU1Q7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLldPTjpcbiAgICAgICAgbGlzdE5hbWUgPSBUcmFkaW5nQXBpLldPTl9MSVNUO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5MT1NUOlxuICAgICAgICBsaXN0TmFtZSA9IFRyYWRpbmdBcGkuTE9TVF9MSVNUO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5CRVNUX09GRkVSOlxuICAgICAgICBsaXN0TmFtZSA9IFRyYWRpbmdBcGkuQkVTVF9PRkZFUl9MSVNUO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5TRUxMSU5HOlxuICAgICAgICBsaXN0TmFtZSA9IFRyYWRpbmdBcGkuQUNUSVZFX0xJU1Q7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLlNPTEQ6XG4gICAgICAgIGxpc3ROYW1lID0gVHJhZGluZ0FwaS5TT0xEX0xJU1Q7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLlVOU09MRDpcbiAgICAgICAgbGlzdE5hbWUgPSBUcmFkaW5nQXBpLlVOU09MRF9MSVNUO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5TQ0hFRFVMRUQ6XG4gICAgICAgIGxpc3ROYW1lID0gVHJhZGluZ0FwaS5TQ0hFRFVMRURfTElTVDtcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICAgIGlmIChsaXN0TmFtZSkge1xuICAgICAga2V5cyA9IE15RWJheVNlcnZpY2UuZ2V0UmVmaW5lKGxpc3ROYW1lKTtcbiAgICB9XG5cbiAgICByZXR1cm4ga2V5cztcbiAgfSxcblxuICBfYXBwbHlSZWZpbmVLZXlzIDogZnVuY3Rpb24oYU9iamVjdCkge1xuICAgIHZhciBsaXN0TmFtZTtcblxuICAgIHN3aXRjaCAodGhpcy5fY3VycmVudExpc3RUeXBlKSB7XG4gICAgICBjYXNlIEl0ZW0uVFlQRVMuV0FUQ0hJTkc6XG4gICAgICAgIGxpc3ROYW1lID0gVHJhZGluZ0FwaS5XQVRDSF9MSVNUO1xuICAgICAgICBNeUViYXlTZXJ2aWNlLnNldFJlZmluZShsaXN0TmFtZSwgYU9iamVjdCk7XG4gICAgICAgIE15RWJheVNlcnZpY2UubG9hZEJ1eWluZ0xpc3REYXRhKHtcbiAgICAgICAgICBuYW1lOiBsaXN0TmFtZVxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEl0ZW0uVFlQRVMuV09OOlxuICAgICAgICBsaXN0TmFtZSA9IFRyYWRpbmdBcGkuV09OX0xJU1Q7XG4gICAgICAgIE15RWJheVNlcnZpY2Uuc2V0UmVmaW5lKGxpc3ROYW1lLCBhT2JqZWN0KTtcbiAgICAgICAgTXlFYmF5U2VydmljZS5sb2FkQnV5aW5nTGlzdERhdGEoe1xuICAgICAgICAgIG5hbWU6IGxpc3ROYW1lLFxuICAgICAgICAgIGVudHJpZXNQZXJQYWdlOiBNeUViYXlTZXJ2aWNlLkxJU1RfSVRFTV9CQVRDSF9TSVpFXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5MT1NUOlxuICAgICAgICBsaXN0TmFtZSA9IFRyYWRpbmdBcGkuTE9TVF9MSVNUO1xuICAgICAgICBNeUViYXlTZXJ2aWNlLnNldFJlZmluZShsaXN0TmFtZSwgYU9iamVjdCk7XG4gICAgICAgIE15RWJheVNlcnZpY2UubG9hZEJ1eWluZ0xpc3REYXRhKHtcbiAgICAgICAgICBuYW1lOiBsaXN0TmFtZSxcbiAgICAgICAgICBlbnRyaWVzUGVyUGFnZTogTXlFYmF5U2VydmljZS5MSVNUX0lURU1fQkFUQ0hfU0laRVxuICAgICAgICB9KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEl0ZW0uVFlQRVMuQkVTVF9PRkZFUjpcbiAgICAgICAgbGlzdE5hbWUgPSBUcmFkaW5nQXBpLkJFU1RfT0ZGRVJfTElTVDtcbiAgICAgICAgTXlFYmF5U2VydmljZS5zZXRSZWZpbmUobGlzdE5hbWUsIGFPYmplY3QpO1xuICAgICAgICBNeUViYXlTZXJ2aWNlLmxvYWRCdXlpbmdMaXN0RGF0YSh7XG4gICAgICAgICAgbmFtZTogbGlzdE5hbWUsXG4gICAgICAgICAgZW50cmllc1BlclBhZ2U6IE15RWJheVNlcnZpY2UuTElTVF9JVEVNX0JBVENIX1NJWkVcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLlNFTExJTkc6XG4gICAgICAgIGxpc3ROYW1lID0gVHJhZGluZ0FwaS5BQ1RJVkVfTElTVDtcbiAgICAgICAgTXlFYmF5U2VydmljZS5zZXRSZWZpbmUobGlzdE5hbWUsIGFPYmplY3QpO1xuICAgICAgICBNeUViYXlTZXJ2aWNlLmxvYWRTZWxsaW5nTGlzdERhdGEoe1xuICAgICAgICAgIG5hbWU6IGxpc3ROYW1lLFxuICAgICAgICAgIGVudHJpZXNQZXJQYWdlOiBNeUViYXlTZXJ2aWNlLkxJU1RfSVRFTV9CQVRDSF9TSVpFXG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5TT0xEOlxuICAgICAgICBsaXN0TmFtZSA9IFRyYWRpbmdBcGkuU09MRF9MSVNUO1xuICAgICAgICBNeUViYXlTZXJ2aWNlLnNldFJlZmluZShsaXN0TmFtZSwgYU9iamVjdCk7XG4gICAgICAgIE15RWJheVNlcnZpY2UubG9hZFNlbGxpbmdMaXN0RGF0YSh7XG4gICAgICAgICAgbmFtZTogbGlzdE5hbWUsXG4gICAgICAgICAgZW50cmllc1BlclBhZ2U6IE15RWJheVNlcnZpY2UuTElTVF9JVEVNX0JBVENIX1NJWkVcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLlVOU09MRDpcbiAgICAgICAgbGlzdE5hbWUgPSBUcmFkaW5nQXBpLlVOU09MRF9MSVNUO1xuICAgICAgICBNeUViYXlTZXJ2aWNlLnNldFJlZmluZShsaXN0TmFtZSwgYU9iamVjdCk7XG4gICAgICAgIE15RWJheVNlcnZpY2UubG9hZFNlbGxpbmdMaXN0RGF0YSh7XG4gICAgICAgICAgbmFtZTogbGlzdE5hbWUsXG4gICAgICAgICAgZW50cmllc1BlclBhZ2U6IE15RWJheVNlcnZpY2UuTElTVF9JVEVNX0JBVENIX1NJWkVcbiAgICAgICAgfSk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfSxcblxuICBfYXBwbHkgOiBmdW5jdGlvbigpIHtcbiAgICB2YXIgYXBwbHlPYmogPSB7fTtcbiAgICB2YXIgcGFyZW50cyA9IG51bGw7XG4gICAgdmFyIGtleSA9IG51bGw7XG5cbiAgICB2YXIgc29ydEtleUVsZW1lbnQgPSAkKFwiI3JlZmluZS1zb3J0LWJ5LWxpc3QgaW5wdXRbdHlwZT0ncmFkaW8nXTpjaGVja2VkXCIpO1xuXG4gICAgaWYgKDAgPCBzb3J0S2V5RWxlbWVudC5sZW5ndGgpIHtcbiAgICAgIHBhcmVudHMgPSAkKHNvcnRLZXlFbGVtZW50KS5wYXJlbnRzKFwiLnJlZmluZS1pdGVtLWNvbnRhaW5lclwiKTtcblxuICAgICAgaWYgKDAgPCBwYXJlbnRzLmxlbmd0aCkge1xuICAgICAgICBrZXkgPSAkKHBhcmVudHNbMF0pLmRhdGEoXCJlbnRyeU9iamVjdFwiKS5rZXk7XG4gICAgICAgIGlmIChrZXkpIHtcbiAgICAgICAgICBhcHBseU9iai5zb3J0ID0ga2V5O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcGFyZW50ID0gbnVsbDtcbiAgICBrZXkgPSBudWxsO1xuICAgIHZhciBmaWx0ZXJLZXlFbGVtZW50ID0gJChcIiNyZWZpbmUtZmlsdGVyLWJ5LWxpc3QgaW5wdXRbdHlwZT0ncmFkaW8nXTpjaGVja2VkXCIpO1xuICAgIGlmICgwIDwgZmlsdGVyS2V5RWxlbWVudC5sZW5ndGgpIHtcbiAgICAgIHBhcmVudHMgPSAkKGZpbHRlcktleUVsZW1lbnQpLnBhcmVudHMoXCIucmVmaW5lLWl0ZW0tY29udGFpbmVyXCIpO1xuXG4gICAgICBpZiAoMCA8IHBhcmVudHMubGVuZ3RoKSB7XG4gICAgICAgIGtleSA9ICQocGFyZW50c1swXSkuZGF0YShcImVudHJ5T2JqZWN0XCIpLmtleTtcbiAgICAgICAgaWYgKGtleSkge1xuICAgICAgICAgIGFwcGx5T2JqLmZpbHRlciA9IGtleTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuX2FwcGx5UmVmaW5lS2V5cyhhcHBseU9iaik7XG4gIH0sXG5cbiAgX3Jlc2V0IDogZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5fYXBwbHlSZWZpbmVLZXlzKHsgc29ydDogbnVsbCwgZmlsdGVyOiBudWxsIH0pO1xuICB9XG59O1xuXG4kKHdpbmRvdykudW5sb2FkKGZ1bmN0aW9uKCkgeyBSZWZpbmVDb250YWluZXIudW5pbml0KCk7IH0pO1xuIl19