/*!
 * Copyright (C) 2007-2015 eBay Inc. All Rights Reserved.
 */
var Sidebar = {
    init: function () {
        ObserverHelper.addObserver(this, Topics.ACCOUNT_SIGNED_IN);
        ObserverHelper.addObserver(this, Topics.ACCOUNT_SIGNED_OUT);
        ObserverHelper.addObserver(this, Topics.CONNECTION_OFFLINE);
        ObserverHelper.addObserver(this, Topics.CONNECTION_ONLINE);
        $("[rel^=i18n],[title^=i18n]").i18n({ attributeNames: ["title"] });
        var mainWindow = $("#main-window");
        var client = UtilityHelper.getClient();
        mainWindow.addClass(UtilityHelper.getBrowserLanguage() + " " + client.os + " " +
            client.osVersion + " " + Configs.BROWSER);
        var activeAccount = Account.getAccount();
        this.setOnlineState();
        this._loadInnerPages();
        this._addRemoveFocusOutlineListeners();
        this._setSignInState(activeAccount);
        EventAnalytics.push({
            key: "OpenApp",
            action: activeAccount ? "SignedIn" : "SignedOut"
        });
        $(document).on("click", function (e) {
            if (e.which === 2) {
                e.preventDefault();
            }
        }).on("contextmenu", function (e) {
            var element = $(e.target);
            if (element.parents("a").length > 0 || element.get(0).nodeName == "A") {
                e.preventDefault();
            }
        });
        UpdateController.forceRefresh(true);
    },
    uninit: function () {
        ObserverHelper.removeObserver(this, Topics.ACCOUNT_SIGNED_IN);
        ObserverHelper.removeObserver(this, Topics.ACCOUNT_SIGNED_OUT);
        ObserverHelper.removeObserver(this, Topics.CONNECTION_OFFLINE);
        ObserverHelper.removeObserver(this, Topics.CONNECTION_ONLINE);
    },
    _addRemoveFocusOutlineListeners: function () {
        $(document).mousedown(function (aEvent) {
            $("#main-window").removeClass("showOutline");
        });
        $(document).keydown(function (aEvent) {
            if (!$("#main-window").hasClass("showOutline")) {
                $("#main-window").addClass("showOutline");
                $(".tab-item.active").focus();
                $("#search-textbox").attr("tabindex", "0");
            }
        });
    },
    _loadInnerPages: function () {
        $("#search").load("core/searchBox.html", function () {
            SearchBox.init();
        });
        $("#panels").load("core/panelContainer.html", function () {
            PanelContainer.init();
        });
        $("#sign-in").load("core/signInForm.html", function () {
            SignInForm.init();
        });
        $("#status-panel").load("core/statusPanel.html", function () {
            StatusPanel.init();
        });
        $("#tabs").load("core/tabContainer.html", function () {
            TabContainer.init();
        });
        $("#signed-in-search-content").load("core/searchContent.html", function () {
            SearchContent.init();
        });
        $("#refine-content").load("core/refineContainer.html", function () {
            RefineContainer.init();
        });
        $("#message-panel").load("core/messagePanel.html", function () {
            MessagePanel.init();
        });
    },
    _setSignInState: function (aAccount) {
        if (aAccount) {
            $("#signed-out-content").hide();
            $("#signed-in-content").show();
            $("#status-panel").show();
        }
        else {
            $("#signed-in-content").hide();
            $("#signed-out-content").show();
            setTimeout(function () {
                $("#status-panel").hide();
            }, 0);
        }
    },
    setOnlineState: function () {
        if (!UtilityHelper.internetConnectionExists()) {
            $("#sidebar-container-online").hide();
            $("#sidebar-container-offline").show();
        }
        else {
            $("#sidebar-container-offline").hide();
            $("#sidebar-container-online").show();
        }
    },
    hideOnlineOfflineContainers: function () {
        $("#sidebar-container-offline").hide();
        $("#sidebar-container-online").hide();
    },
    updateTooltips: function () {
    },
    styleScroll: function (aId, aOverflowYCallback, aOverflowYNoneCallback, aWhileScrolling, aTotalScroll, aTotalScrollBack) {
        var data = {
            theme: "minimal-dark",
            scrollInertia: 70,
            advanced: {
                autoScrollOnFocus: 'a.item-box-container, a.search-content-block-item-link'
            }
        };
        var callbacks = {};
        if (aOverflowYCallback) {
            callbacks.onOverflowY = aOverflowYCallback;
        }
        if (aOverflowYNoneCallback) {
            callbacks.onOverflowYNone = aOverflowYNoneCallback;
        }
        if (aWhileScrolling) {
            callbacks.whileScrolling = aWhileScrolling;
        }
        if (aTotalScroll) {
            callbacks.onTotalScroll = aTotalScroll;
            callbacks.onTotalScrollOffset = 0;
        }
        if (aTotalScrollBack) {
            callbacks.onTotalScrollBack = aTotalScrollBack;
        }
        callbacks.onCreate = function () {
            $(".mCustomScrollBox").attr("tabindex", "-1");
        };
        callbacks.onInit = function () {
            $(".mCustomScrollBox").attr("tabindex", "-1");
        };
        callbacks.onUpdate = function () {
            $(".mCustomScrollBox").attr("tabindex", "-1");
        };
        data.callbacks = callbacks;
        $("#" + aId).mCustomScrollbar(data);
    },
    scrollToTop: function (aId) {
        $("#" + aId).mCustomScrollbar("scrollTo", "top", { scrollInertia: 0 });
    },
    scrollToBottom: function (aId) {
        $("#" + aId).mCustomScrollbar("scrollTo", "bottom", { scrollInertia: 0 });
    },
    setElementDisplayed: function (aElement, aShouldDisplay) {
        var element = $(aElement);
        if (element && element.length > 0) {
            if (aShouldDisplay) {
                element.show();
            }
            else {
                element.hide();
            }
        }
    },
    apiHasItems: function (aElement) {
        var hasItems = false;
        switch (aElement) {
            case "notification":
                hasItems = PanelNotification.apiHasItems();
                break;
            case "watching":
                hasItems = PanelWatching.apiHasItems();
                break;
            case "buying":
                hasItems = PanelBuying.apiHasItems();
                break;
            case "selling":
                hasItems = PanelSelling.apiHasItems();
                break;
        }
        return hasItems;
    },
    isApiLoading: function (aElement) {
        var isLoading = false;
        switch (aElement) {
            case "notification":
                isLoading = SymbanService.isUpdatingData;
                break;
            case "watching":
                isLoading = MyEbayService.isUpdatingBuyingData;
                break;
            case "buying":
                isLoading = MyEbayService.isUpdatingBuyingData;
                break;
            case "selling":
                isLoading = MyEbayService.isUpdatingSellingData;
                break;
        }
        return isLoading;
    },
    showLoading: function (aElement) {
        var element = $("#panel-" + aElement + "-loading");
        var elementLazyLoading = $("#panel-" + aElement + "-lazy-loading");
        var isLoading = this.isApiLoading(aElement);
        if (!isLoading) {
            this.setClickEvents(true, element);
            element.hide();
        }
        else {
            if (!elementLazyLoading.is(":visible")) {
                if ($("#panel-" + aElement + "-empty").is(":visible") === false &&
                    this.apiHasItems(aElement)) {
                    element.addClass("panel-loading-spinner-lock");
                }
                else {
                    element.removeClass("panel-loading-spinner-lock");
                }
                element.show();
                this.setClickEvents(false, element);
            }
        }
    },
    setClickEvents: function (aCanClick, aElement) {
        var lastSelectedTabId = $(".tab-item.active").attr("id");
        var isSameTab = false;
        if (aElement && aElement.hasClass(lastSelectedTabId)) {
            isSameTab = true;
        }
        if (isSameTab) {
            if (aCanClick) {
                $("#signed-in-content").removeClass("disabled-click");
                $("#signed-in-content").addClass("enabled-click");
            }
            else {
                $("#signed-in-content").removeClass("enabled-click");
                $("#signed-in-content").addClass("disabled-click");
            }
        }
    },
    adjustTabIndex: function () {
        if ("Window" == UtilityHelper.getClient().os) {
            $('div[tabindex], span[tabindex]').each(function (aIndex, aElement) {
                var element = $(aElement);
                if (0 <= parseInt(element.attr("tabindex"))) {
                    element.removeAttr("tabindex");
                    var parents = element.parents("a");
                    if (0 < parents.length) {
                        $(parents[0]).attr("tabindex", "0");
                    }
                }
            });
            $('#user-menu li').each(function (aIndex, aElement) {
                var element = $(aElement);
                element.removeAttr("tabindex");
                element.find("a").attr("tabindex", 0);
            });
        }
    },
    removeTabIndex: function () {
        if (Configs.BROWSER !== "fx") {
            $("#main-window *").removeAttr("tabindex");
            $("#main-window").attr("tabindex", "-1");
        }
    },
    getGATabTrackingName: function (aTabName) {
        switch (aTabName) {
            case "tab-watching":
                return "Watching";
                break;
            case "tab-selling":
                return "Selling";
                break;
            case "tab-buying":
                return "Buying";
                break;
            case "tab-notification":
                return "Notifications";
                break;
            case "search-tab-recent-searches":
                return "RecentSearches";
                break;
            case "search-tab-followed-searches":
                return "FollowedSearches";
                break;
            default:
                return "Notifications";
        }
    },
    getGAListTypeTrackingName: function (aListType) {
        switch (aListType) {
            case Item.TYPES.WATCHING:
                return "Watching";
            case Item.TYPES.SELLING:
                return "SellingActive";
                break;
            case Item.TYPES.SELLING_OFFER:
                return "SellingOffers";
                break;
            case Item.TYPES.SOLD:
                return "SellingSold";
                break;
            case Item.TYPES.UNSOLD:
                return "SellingUnsold";
                break;
            case Item.TYPES.SCHEDULED:
                return "SellingScheduled";
                break;
            case Item.TYPES.BIDDING:
                return "BuyingBids";
                break;
            case Item.TYPES.BEST_OFFER:
                return "BuyingBestOffer";
                break;
            case Item.TYPES.WON:
                return "BuyingWon";
                break;
            case Item.TYPES.LOST:
                return "BuyingLost";
                break;
            default:
                return "Watching";
        }
    },
    observe: function (aTopic, aData) {
        switch (aTopic) {
            case Topics.ACCOUNT_SIGNED_IN:
                this._setSignInState(aData.account);
                break;
            case Topics.ACCOUNT_SIGNED_OUT:
                this._setSignInState(null);
                break;
            case Topics.CONNECTION_OFFLINE:
            case Topics.CONNECTION_ONLINE:
                this.setOnlineState();
                break;
        }
    }
};
$(document).ready(function () { Sidebar.init(); });
$(window).unload(function () { Sidebar.uninit(); });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lkZWJhci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3VpL3ZpZXcvY29yZS9zaWRlYmFyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOztHQUVHO0FBS0gsSUFBSSxPQUFPLEdBQUc7SUFFWixJQUFJLEVBQUc7UUFDTCxjQUFjLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUMzRCxjQUFjLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUM1RCxjQUFjLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsa0JBQWtCLENBQUMsQ0FBQztRQUM1RCxjQUFjLENBQUMsV0FBVyxDQUFDLElBQUksRUFBRSxNQUFNLENBQUMsaUJBQWlCLENBQUMsQ0FBQztRQUczRCxDQUFDLENBQUMsMkJBQTJCLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxjQUFjLEVBQUUsQ0FBRSxPQUFPLENBQUUsRUFBRSxDQUFDLENBQUM7UUFHckUsSUFBSSxVQUFVLEdBQUcsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxDQUFDO1FBQ25DLElBQUksTUFBTSxHQUFHLGFBQWEsQ0FBQyxTQUFTLEVBQUUsQ0FBQztRQUN2QyxVQUFVLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEdBQUcsR0FBRyxNQUFNLENBQUMsRUFBRSxHQUFHLEdBQUc7WUFDNUUsTUFBTSxDQUFDLFNBQVMsR0FBRyxHQUFHLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBRSxDQUFDO1FBRzdDLElBQUksYUFBYSxHQUFHLE9BQU8sQ0FBQyxVQUFVLEVBQUUsQ0FBQztRQUN6QyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7UUFDdEIsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDO1FBQ3ZCLElBQUksQ0FBQywrQkFBK0IsRUFBRSxDQUFDO1FBQ3ZDLElBQUks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QUFLLENBQUMsT0FBTyxDQUFDLENBQUM7Z0JBQ3BDLEtBQUssQ0FBQztZQUNSLEtBQUssTUFBTSxDQUFDLGtCQUFrQjtnQkFDNUIsSUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsQ0FBQztnQkFDM0IsS0FBSyxDQUFDO1lBQ1IsS0FBSyxNQUFNLENBQUMsa0JBQWtCLENBQUM7WUFDL0IsS0FBSyxNQUFNLENBQUMsaUJBQWlCO2dCQUMzQixJQUFJLENBQUMsY0FBYyxFQUFFLENBQUM7Z0JBQ3RCLEtBQUssQ0FBQztRQUNWLENBQUM7SUFDSCxDQUFDO0NBQ0YsQ0FBQztBQUVGLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxLQUFLLENBQUMsY0FBYSxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNsRCxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsTUFBTSxDQUFDLGNBQWEsT0FBTyxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiFcbiAqIENvcHlyaWdodCAoQykgMjAwNy0yMDE1IGVCYXkgSW5jLiBBbGwgUmlnaHRzIFJlc2VydmVkLlxuICovXG5cbi8qKlxuICogU2lkZWJhciBDbGFzcy5cbiAqL1xudmFyIFNpZGViYXIgPSB7XG5cbiAgaW5pdCA6IGZ1bmN0aW9uKCkge1xuICAgIE9ic2VydmVySGVscGVyLmFkZE9ic2VydmVyKHRoaXMsIFRvcGljcy5BQ0NPVU5UX1NJR05FRF9JTik7XG4gICAgT2JzZXJ2ZXJIZWxwZXIuYWRkT2JzZXJ2ZXIodGhpcywgVG9waWNzLkFDQ09VTlRfU0lHTkVEX09VVCk7XG4gICAgT2JzZXJ2ZXJIZWxwZXIuYWRkT2JzZXJ2ZXIodGhpcywgVG9waWNzLkNPTk5FQ1RJT05fT0ZGTElORSk7XG4gICAgT2JzZXJ2ZXJIZWxwZXIuYWRkT2JzZXJ2ZXIodGhpcywgVG9waWNzLkNPTk5FQ1RJT05fT05MSU5FKTtcblxuICAgIC8vIEFwcGx5IGxvY2FsZSB0byB0aGUgcmVsZXZhbnQgbm9kZXMuXG4gICAgJChcIltyZWxePWkxOG5dLFt0aXRsZV49aTE4bl1cIikuaTE4bih7IGF0dHJpYnV0ZU5hbWVzOiBbIFwidGl0bGVcIiBdIH0pO1xuXG4gICAgLy8gVUkgbG9jYWxlIGFuZCBvcyBmb3Igc3R5bGluZ1xuICAgIHZhciBtYWluV2luZG93ID0gJChcIiNtYWluLXdpbmRvd1wiKTtcbiAgICB2YXIgY2xpZW50ID0gVXRpbGl0eUhlbHBlci5nZXRDbGllbnQoKTtcbiAgICBtYWluV2luZG93LmFkZENsYXNzKFV0aWxpdHlIZWxwZXIuZ2V0QnJvd3Nlckxhbmd1YWdlKCkgKyBcIiBcIiArIGNsaWVudC5vcyArIFwiIFwiICtcbiAgICAgIGNsaWVudC5vc1ZlcnNpb24gKyBcIiBcIiArIENvbmZpZ3MuQlJPV1NFUiApO1xuXG4gICAgLy8gY2xlYXIgdGhlIGZvY3VzIG91dGxpbmUgZm9yIEFzIGFuZCBCdXR0b25zXG4gICAgdmFyIGFjdGl2ZUFjY291bnQgPSBBY2NvdW50LmdldEFjY291bnQoKTtcbiAgICB0aGlzLnNldE9ubGluZVN0YXRlKCk7XG4gICAgdGhpcy5fbG9hZElubmVyUGFnZXMoKTtcbiAgICB0aGlzLl9hZGRSZW1vdmVGb2N1c091dGxpbmVMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9zZXRTaWduSW5TdGF0ZShhY3RpdmVBY2NvdW50KTtcblxuICAgIC8vIHRyYWNraW5nXG4gICAgRXZlbnRBbmFseXRpY3MucHVzaCh7XG4gICAgICBrZXk6IFwiT3BlbkFwcFwiLFxuICAgICAgYWN0aW9uOiBhY3RpdmVBY2NvdW50ID8gXCJTaWduZWRJblwiIDogXCJTaWduZWRPdXRcIlxuICAgIH0pO1xuXG4gICAgLy8gcHJldmVudCBtaWRkbGUgY2xpY2sgdG8gb3BlbiBleHRlbnNpb24gcGFnZSBpbiBhIHRhYiBhbmQgcHJldmVudCBBIHRhZyB0byBkaXNwbGF5IGNvbnRleHQgbWVudVxuICAgICQoZG9jdW1lbnQpLm9uKFwiY2xpY2tcIiwgZnVuY3Rpb24oZSkge1xuICAgICAgaWYgKGUud2hpY2ggPT09IDIpIHtcbiAgICAgICAgLy9UT0RPOiB1bmNvbW1lbnQgdGhpcyBjb2RlIGJlZm9yZSByZWxlYXNlLlxuICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB9XG4gICAgfSkub24oXCJjb250ZXh0bWVudVwiLGZ1bmN0aW9uKGUpIHtcbiAgICAgIHZhciBlbGVtZW50ID0gJChlLnRhcmdldCk7XG4gICAgICBpZiAoZWxlbWVudC5wYXJlbnRzKFwiYVwiKS5sZW5ndGggPiAwIHx8IGVsZW1lbnQuZ2V0KDApLm5vZGVOYW1lID09IFwiQVwiKSB7XG4gICAgICAgIC8vVE9ETzogdW5jb21tZW50IHRoaXMgY29kZSBiZWZvcmUgcmVsZWFzZS5cbiAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgVXBkYXRlQ29udHJvbGxlci5mb3JjZVJlZnJlc2godHJ1ZSk7XG4gIH0sXG5cbiAgdW5pbml0IDogZnVuY3Rpb24oKSB7XG4gICAgT2JzZXJ2ZXJIZWxwZXIucmVtb3ZlT2JzZXJ2ZXIodGhpcywgVG9waWNzLkFDQ09VTlRfU0lHTkVEX0lOKTtcbiAgICBPYnNlcnZlckhlbHBlci5yZW1vdmVPYnNlcnZlcih0aGlzLCBUb3BpY3MuQUNDT1VOVF9TSUdORURfT1VUKTtcbiAgICBPYnNlcnZlckhlbHBlci5yZW1vdmVPYnNlcnZlcih0aGlzLCBUb3BpY3MuQ09OTkVDVElPTl9PRkZMSU5FKTtcbiAgICBPYnNlcnZlckhlbHBlci5yZW1vdmVPYnNlcnZlcih0aGlzLCBUb3BpY3MuQ09OTkVDVElPTl9PTkxJTkUpO1xuICB9LFxuXG4gIF9hZGRSZW1vdmVGb2N1c091dGxpbmVMaXN0ZW5lcnM6IGZ1bmN0aW9uKCkge1xuICAgICQoZG9jdW1lbnQpLm1vdXNlZG93bihmdW5jdGlvbihhRXZlbnQpIHtcbiAgICAgICQoXCIjbWFpbi13aW5kb3dcIikucmVtb3ZlQ2xhc3MoXCJzaG93T3V0bGluZVwiKTtcbiAgICB9KTtcbiAgICAkKGRvY3VtZW50KS5rZXlkb3duKGZ1bmN0aW9uKGFFdmVudCkge1xuICAgICAgaWYgKCEkKFwiI21haW4td2luZG93XCIpLmhhc0NsYXNzKFwic2hvd091dGxpbmVcIikpIHtcbiAgICAgICAgJChcIiNtYWluLXdpbmRvd1wiKS5hZGRDbGFzcyhcInNob3dPdXRsaW5lXCIpO1xuICAgICAgICAvL3NldCBmb2N1cyB0byB0aGUgc2VsZWN0ZWQgdGFiXG4gICAgICAgICQoXCIudGFiLWl0ZW0uYWN0aXZlXCIpLmZvY3VzKCk7XG4gICAgICAgIC8vcmVzdG9yZSB0aGUgdGFiaW5kZXggdG8gdGhlIHNlYXJjaCB0ZXh0Ym94XG4gICAgICAgICQoXCIjc2VhcmNoLXRleHRib3hcIikuYXR0cihcInRhYmluZGV4XCIsIFwiMFwiKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSxcblxuICBfbG9hZElubmVyUGFnZXMgOiBmdW5jdGlvbigpIHtcbiAgICAkKFwiI3NlYXJjaFwiKS5sb2FkKFwiY29yZS9zZWFyY2hCb3guaHRtbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgIFNlYXJjaEJveC5pbml0KCk7XG4gICAgfSk7XG4gICAgJChcIiNwYW5lbHNcIikubG9hZChcImNvcmUvcGFuZWxDb250YWluZXIuaHRtbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgIFBhbmVsQ29udGFpbmVyLmluaXQoKTtcbiAgICB9KTtcbiAgICAkKFwiI3NpZ24taW5cIikubG9hZChcImNvcmUvc2lnbkluRm9ybS5odG1sXCIsIGZ1bmN0aW9uKCkge1xuICAgICAgU2lnbkluRm9ybS5pbml0KCk7XG4gICAgfSk7XG4gICAgJChcIiNzdGF0dXMtcGFuZWxcIikubG9hZChcImNvcmUvc3RhdHVzUGFuZWwuaHRtbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgIFN0YXR1c1BhbmVsLmluaXQoKTtcbiAgICB9KTtcbiAgICAkKFwiI3RhYnNcIikubG9hZChcImNvcmUvdGFiQ29udGFpbmVyLmh0bWxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBUYWJDb250YWluZXIuaW5pdCgpO1xuICAgIH0pO1xuICAgICQoXCIjc2lnbmVkLWluLXNlYXJjaC1jb250ZW50XCIpLmxvYWQoXCJjb3JlL3NlYXJjaENvbnRlbnQuaHRtbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgIFNlYXJjaENvbnRlbnQuaW5pdCgpO1xuICAgIH0pO1xuICAgICQoXCIjcmVmaW5lLWNvbnRlbnRcIikubG9hZChcImNvcmUvcmVmaW5lQ29udGFpbmVyLmh0bWxcIiwgZnVuY3Rpb24oKSB7XG4gICAgICBSZWZpbmVDb250YWluZXIuaW5pdCgpO1xuICAgIH0pO1xuICAgICQoXCIjbWVzc2FnZS1wYW5lbFwiKS5sb2FkKFwiY29yZS9tZXNzYWdlUGFuZWwuaHRtbFwiLCBmdW5jdGlvbigpIHtcbiAgICAgIE1lc3NhZ2VQYW5lbC5pbml0KCk7XG4gICAgfSk7XG4gIH0sXG5cbiAgX3NldFNpZ25JblN0YXRlIDogZnVuY3Rpb24oYUFjY291bnQpIHtcbiAgICBcbiAgICBpZiAoYUFjY291bnQpIHtcbiAgICAgICQoXCIjc2lnbmVkLW91dC1jb250ZW50XCIpLmhpZGUoKTtcbiAgICAgICQoXCIjc2lnbmVkLWluLWNvbnRlbnRcIikuc2hvdygpO1xuICAgICAgJChcIiNzdGF0dXMtcGFuZWxcIikuc2hvdygpO1xuICAgIH0gZWxzZSB7XG4gICAgICAkKFwiI3NpZ25lZC1pbi1jb250ZW50XCIpLmhpZGUoKTtcbiAgICAgICQoXCIjc2lnbmVkLW91dC1jb250ZW50XCIpLnNob3coKTtcbiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICQoXCIjc3RhdHVzLXBhbmVsXCIpLmhpZGUoKTtcbiAgICAgIH0sIDApO1xuICAgIH1cbiAgfSxcblxuICBzZXRPbmxpbmVTdGF0ZSA6IGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIGlmICghVXRpbGl0eUhlbHBlci5pbnRlcm5ldENvbm5lY3Rpb25FeGlzdHMoKSkge1xuICAgICAgJChcIiNzaWRlYmFyLWNvbnRhaW5lci1vbmxpbmVcIikuaGlkZSgpO1xuICAgICAgJChcIiNzaWRlYmFyLWNvbnRhaW5lci1vZmZsaW5lXCIpLnNob3coKTtcbiAgICB9IGVsc2Uge1xuICAgICAgJChcIiNzaWRlYmFyLWNvbnRhaW5lci1vZmZsaW5lXCIpLmhpZGUoKTtcbiAgICAgICQoXCIjc2lkZWJhci1jb250YWluZXItb25saW5lXCIpLnNob3coKTtcbiAgICB9XG4gIH0sXG5cbiAgaGlkZU9ubGluZU9mZmxpbmVDb250YWluZXJzIDogZnVuY3Rpb24oKSB7XG4gICAgJChcIiNzaWRlYmFyLWNvbnRhaW5lci1vZmZsaW5lXCIpLmhpZGUoKTtcbiAgICAkKFwiI3NpZGViYXItY29udGFpbmVyLW9ubGluZVwiKS5oaWRlKCk7XG4gIH0sXG5cbiAgdXBkYXRlVG9vbHRpcHMgOiBmdW5jdGlvbigpIHtcbiAgICAvKiBUT0RPOiBkaXNhYmxlIHRoZSB0b29sdGlwcyBiYXNlZCBvbiBKb25ueSByZXF1ZXN0cy5cbiAgICAkKFwiYnV0dG9uW2RhdGEtdXBkYXRlLXRvb2x0aXA9J3RydWUnXSxhW2RhdGEtdXBkYXRlLXRvb2x0aXA9J3RydWUnXVwiKS5lYWNoKGZ1bmN0aW9uKCkge1xuICAgICAgdmFyIHZhbHVlO1xuICAgICAgdmFyIHRpdGxlID0gJCh0aGlzKS5hdHRyKFwidGl0bGVcIik7XG4gICAgICBpZiAodGl0bGUpIHtcbiAgICAgICAgdmFsdWUgPSAkLmkxOG4uZ2V0U3RyaW5nKFwiZ2VuZXJhbF9vcGVuTGlua0luQnJvd3NlclRhYl90b29sdGlwXCIsIFt0aXRsZV0pO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdmFsdWUgPSAkLmkxOG4uZ2V0U3RyaW5nKFwiZ2VuZXJhbF9vcGVuSW5Ccm93c2VyVGFiX3Rvb2x0aXBcIik7XG4gICAgICB9XG4gICAgICAkKHRoaXMpLmF0dHIoXCJ0aXRsZVwiLCB2YWx1ZSk7XG4gICAgICAkKHRoaXMpLmF0dHIoXCJkYXRhLXVwZGF0ZS10b29sdGlwXCIsIFwiZmFsc2VcIik7XG4gICAgfSk7XG4gICAgKi9cbiAgfSxcblxuICBzdHlsZVNjcm9sbCA6IGZ1bmN0aW9uKGFJZCwgYU92ZXJmbG93WUNhbGxiYWNrLCBhT3ZlcmZsb3dZTm9uZUNhbGxiYWNrLFxuICAgICAgICAgICAgICAgICAgICAgICAgIGFXaGlsZVNjcm9sbGluZywgYVRvdGFsU2Nyb2xsLCBhVG90YWxTY3JvbGxCYWNrKSB7XG4gICAgdmFyIGRhdGEgPSB7XG4gICAgICB0aGVtZTogXCJtaW5pbWFsLWRhcmtcIixcbiAgICAgIHNjcm9sbEluZXJ0aWE6IDcwLFxuICAgICAgYWR2YW5jZWQ6IHtcbiAgICAgICAgYXV0b1Njcm9sbE9uRm9jdXM6ICdhLml0ZW0tYm94LWNvbnRhaW5lciwgYS5zZWFyY2gtY29udGVudC1ibG9jay1pdGVtLWxpbmsnXG4gICAgICB9XG4gICAgfTtcbiAgICB2YXIgY2FsbGJhY2tzID0ge307XG4gICAgaWYgKGFPdmVyZmxvd1lDYWxsYmFjaykge1xuICAgICAgY2FsbGJhY2tzLm9uT3ZlcmZsb3dZID0gYU92ZXJmbG93WUNhbGxiYWNrO1xuICAgIH1cbiAgICBpZiAoYU92ZXJmbG93WU5vbmVDYWxsYmFjaykge1xuICAgICAgY2FsbGJhY2tzLm9uT3ZlcmZsb3dZTm9uZSA9IGFPdmVyZmxvd1lOb25lQ2FsbGJhY2s7XG4gICAgfVxuICAgIGlmIChhV2hpbGVTY3JvbGxpbmcpIHtcbiAgICAgIGNhbGxiYWNrcy53aGlsZVNjcm9sbGluZyA9IGFXaGlsZVNjcm9sbGluZztcbiAgICB9XG4gICAgaWYgKGFUb3RhbFNjcm9sbCkge1xuICAgICAgY2FsbGJhY2tzLm9uVG90YWxTY3JvbGwgPSBhVG90YWxTY3JvbGw7XG4gICAgICBjYWxsYmFja3Mub25Ub3RhbFNjcm9sbE9mZnNldCA9IDA7XG4gICAgfVxuICAgIGlmIChhVG90YWxTY3JvbGxCYWNrKSB7XG4gICAgICBjYWxsYmFja3Mub25Ub3RhbFNjcm9sbEJhY2sgPSBhVG90YWxTY3JvbGxCYWNrO1xuICAgIH1cblxuICAgIC8vYWRkZWQgdGhlc2UgY2FsbGJhY2tzIHRvIHByZXZlbnQgdGhlIHNjcm9sbGJhciBnZXQgZm9jdXMgd2hlbiBpdCBzaG91bGRuJ3QuXG4gICAgY2FsbGJhY2tzLm9uQ3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAkKFwiLm1DdXN0b21TY3JvbGxCb3hcIikuYXR0cihcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gICAgfTtcbiAgICBjYWxsYmFja3Mub25Jbml0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAkKFwiLm1DdXN0b21TY3JvbGxCb3hcIikuYXR0cihcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gICAgfTtcbiAgICBjYWxsYmFja3Mub25VcGRhdGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICQoXCIubUN1c3RvbVNjcm9sbEJveFwiKS5hdHRyKFwidGFiaW5kZXhcIiwgXCItMVwiKTtcbiAgICB9O1xuXG4gICAgZGF0YS5jYWxsYmFja3MgPSBjYWxsYmFja3M7XG4gICAgJChcIiNcIiArIGFJZCkubUN1c3RvbVNjcm9sbGJhcihkYXRhKTtcbiAgfSxcblxuICBzY3JvbGxUb1RvcCA6ICBmdW5jdGlvbihhSWQpIHtcbiAgICAkKFwiI1wiICsgYUlkKS5tQ3VzdG9tU2Nyb2xsYmFyKFxuICAgICAgXCJzY3JvbGxUb1wiLCBcInRvcFwiLCB7IHNjcm9sbEluZXJ0aWE6IDAgfSk7XG4gIH0sXG5cbiAgc2Nyb2xsVG9Cb3R0b20gOiAgZnVuY3Rpb24oYUlkKSB7XG4gICAgJChcIiNcIiArIGFJZCkubUN1c3RvbVNjcm9sbGJhcihcbiAgICAgIFwic2Nyb2xsVG9cIiwgXCJib3R0b21cIiwgeyBzY3JvbGxJbmVydGlhOiAwIH0pO1xuICB9LFxuXG4gIHNldEVsZW1lbnREaXNwbGF5ZWQgOiBmdW5jdGlvbiAoYUVsZW1lbnQsIGFTaG91bGREaXNwbGF5KSB7XG4gICAgdmFyIGVsZW1lbnQgPSAkKGFFbGVtZW50KTtcbiAgICBpZiAoZWxlbWVudCAmJiBlbGVtZW50Lmxlbmd0aCA+IDApIHtcbiAgICAgIGlmIChhU2hvdWxkRGlzcGxheSkge1xuICAgICAgICBlbGVtZW50LnNob3coKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGVsZW1lbnQuaGlkZSgpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogRGV0ZXJtaW5lcyBpZiB0aGUgc3BlY2lmaWMgYXBpIGhhcyBpdGVtcyBvbiBtZW1vcnkuXG4gICAqIEBwYXJhbSBhRWxlbWVudCB0aGUgbmFtZSBvZiB0aGUgYXBpIHRoYXQgaXMgYmVpbmcgdGVzdGVkOiBub3RpZmljYXRpb24sXG4gICAqIHdhdGNoaW5nLCBidXlpbmcgb3Igc2VsbGluZy5cbiAgICogQHJldHVybnMgYm9vbGVhbiB0cnVlIGlmIHRoZSBzcGVjaWZpYyBhcGkgaGFzIGl0ZW1zIG9uIG1lbW9yeSwgZmFsc2UgaWYgdGhlXG4gICAqIHNwZWNpZmljIGFwaSBkb2VzIG5vdCBoYXZlIGl0ZW1zIG9uIG1lbW9yeS5cbiAgICovXG4gIGFwaUhhc0l0ZW1zIDogZnVuY3Rpb24oYUVsZW1lbnQpIHtcbiAgICB2YXIgaGFzSXRlbXMgPSBmYWxzZTtcbiAgICBzd2l0Y2goYUVsZW1lbnQpIHtcbiAgICAgIGNhc2UgXCJub3RpZmljYXRpb25cIjpcbiAgICAgICAgaGFzSXRlbXMgPSBQYW5lbE5vdGlmaWNhdGlvbi5hcGlIYXNJdGVtcygpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJ3YXRjaGluZ1wiOlxuICAgICAgICBoYXNJdGVtcyA9IFBhbmVsV2F0Y2hpbmcuYXBpSGFzSXRlbXMoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwiYnV5aW5nXCI6XG4gICAgICAgIGhhc0l0ZW1zID0gUGFuZWxCdXlpbmcuYXBpSGFzSXRlbXMoKTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwic2VsbGluZ1wiOlxuICAgICAgICBoYXNJdGVtcyA9IFBhbmVsU2VsbGluZy5hcGlIYXNJdGVtcygpO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIGhhc0l0ZW1zO1xuICB9LFxuXG4gIC8qKlxuICAgKiBEZXRlcm1pbmVzIGlmIHRoZSBzcGVjaWZpYyBhcGkgaXMgbG9hZGluZyBkYXRhIGZyb20gdGhlIHNlcnZlci5cbiAgICogQHBhcmFtIGFFbGVtZW50IHRoZSBuYW1lIG9mIHRoZSBhcGkgdGhhdCBpcyBiZWluZyBjYWxsZWQ6IG5vdGlmaWNhdGlvbixcbiAgICogd2F0Y2hpbmcsIGJ1eWluZyBvciBzZWxsaW5nLlxuICAgKiBAcmV0dXJucyBib29sZWFuIHRydWUgaWYgdGhlIHNwZWNpZmljIGFwaSBpcyBsb2FkaW5nLCBmYWxzZSBpZiB0aGUgc3BlY2lmaWNcbiAgICogYXBpIGlzIG5vdCBsb2FkaW5nLlxuICAgKi9cbiAgaXNBcGlMb2FkaW5nIDogZnVuY3Rpb24oYUVsZW1lbnQpIHtcbiAgICB2YXIgaXNMb2FkaW5nID0gZmFsc2U7XG4gICAgc3dpdGNoKGFFbGVtZW50KSB7XG4gICAgICBjYXNlIFwibm90aWZpY2F0aW9uXCI6XG4gICAgICAgIGlzTG9hZGluZyA9IFN5bWJhblNlcnZpY2UuaXNVcGRhdGluZ0RhdGE7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcIndhdGNoaW5nXCI6XG4gICAgICAgIGlzTG9hZGluZyA9IE15RWJheVNlcnZpY2UuaXNVcGRhdGluZ0J1eWluZ0RhdGE7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBcImJ1eWluZ1wiOlxuICAgICAgICBpc0xvYWRpbmcgPSBNeUViYXlTZXJ2aWNlLmlzVXBkYXRpbmdCdXlpbmdEYXRhO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJzZWxsaW5nXCI6XG4gICAgICAgIGlzTG9hZGluZyA9IE15RWJheVNlcnZpY2UuaXNVcGRhdGluZ1NlbGxpbmdEYXRhO1xuICAgICAgICBicmVhaztcbiAgICB9XG4gICAgcmV0dXJuIGlzTG9hZGluZztcbiAgfSxcblxuXG4gIC8qKlxuICAgKiBEaXNwbGF5cyBhIGxvYWRpbmcgaWNvbiBpZiB0aGUgc3BlY2lmaWMgYXBpIGlzIGxvYWRpbmcgZGF0YSBmcm9tIHRoZSBzZXJ2ZXIuXG4gICAqIEBwYXJhbSBhRWxlbWVudCB0aGUgbmFtZSBvZiB0aGUgYXBpIHRoYXQgaXMgYmVpbmcgY2FsbGVkOiBub3RpZmljYXRpb24sXG4gICAqIHdhdGNoaW5nLCBidXlpbmcgb3Igc2VsbGluZy5cbiAgICovXG4gIHNob3dMb2FkaW5nIDogZnVuY3Rpb24oYUVsZW1lbnQpIHtcbiAgICB2YXIgZWxlbWVudCA9ICQoXCIjcGFuZWwtXCIgKyBhRWxlbWVudCArIFwiLWxvYWRpbmdcIik7XG4gICAgdmFyIGVsZW1lbnRMYXp5TG9hZGluZyA9ICQoXCIjcGFuZWwtXCIgKyBhRWxlbWVudCArIFwiLWxhenktbG9hZGluZ1wiKTtcbiAgICB2YXIgaXNMb2FkaW5nID0gdGhpcy5pc0FwaUxvYWRpbmcoYUVsZW1lbnQpO1xuXG4gICAgaWYgKCFpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuc2V0Q2xpY2tFdmVudHModHJ1ZSwgZWxlbWVudCk7XG4gICAgICBlbGVtZW50LmhpZGUoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgaWYgKCFlbGVtZW50TGF6eUxvYWRpbmcuaXMoXCI6dmlzaWJsZVwiKSkge1xuICAgICAgICBpZiAoJChcIiNwYW5lbC1cIiArIGFFbGVtZW50ICsgXCItZW1wdHlcIikuaXMoXCI6dmlzaWJsZVwiKSA9PT0gZmFsc2UgJiZcbiAgICAgICAgICB0aGlzLmFwaUhhc0l0ZW1zKGFFbGVtZW50KSkge1xuICAgICAgICAgIGVsZW1lbnQuYWRkQ2xhc3MoXCJwYW5lbC1sb2FkaW5nLXNwaW5uZXItbG9ja1wiKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBlbGVtZW50LnJlbW92ZUNsYXNzKFwicGFuZWwtbG9hZGluZy1zcGlubmVyLWxvY2tcIik7XG4gICAgICAgIH1cbiAgICAgICAgZWxlbWVudC5zaG93KCk7XG4gICAgICAgIHRoaXMuc2V0Q2xpY2tFdmVudHMoZmFsc2UsIGVsZW1lbnQpO1xuICAgICAgfVxuICAgIH1cbiAgfSxcblxuICAvKipcbiAgICogQmxvY2tzIFVJIGNsaWNrcyBhbmQgc2Nyb2xscyBpZiBhbiBzcGVjaWZpYyBhcGkgaXMgbG9hZGluZyBkYXRhIGZyb20gdGhlIHNlcnZlci5cbiAgICogVW5ibG9ja3MgVUkgY2xpY2tzIGFuZCBzY3JvbGxzIGlmIGFuIHNwZWNpZmljIGFwaSBpcyBub3QgbG9hZGluZyBkYXRhIGZyb20gdGhlIHNlcnZlci5cbiAgICogQHBhcmFtIGFDYW5DbGljayBpbmRpY2F0ZXMgaWYgdGhlIHVzZXIgd291bGQgYmUgYWJsZSB0byBjbGljayBvciBub3Qgb24gdGhlIFVJLlxuICAgKiBAcGFyYW0gYUVsZW1lbnQgdGhlIG5hbWUgb2YgdGhlIGFwaSB0aGF0IGlzIGJlaW5nIGNhbGxlZDogbm90aWZpY2F0aW9uLFxuICAgKiB3YXRjaGluZywgYnV5aW5nIG9yIHNlbGxpbmcuXG4gICAqL1xuICBzZXRDbGlja0V2ZW50cyA6IGZ1bmN0aW9uKGFDYW5DbGljaywgYUVsZW1lbnQpIHtcbiAgICB2YXIgbGFzdFNlbGVjdGVkVGFiSWQgPSAkKFwiLnRhYi1pdGVtLmFjdGl2ZVwiKS5hdHRyKFwiaWRcIik7XG5cbiAgICB2YXIgaXNTYW1lVGFiID0gZmFsc2U7XG4gICAgaWYgKGFFbGVtZW50ICYmIGFFbGVtZW50Lmhhc0NsYXNzKGxhc3RTZWxlY3RlZFRhYklkKSkge1xuICAgICAgaXNTYW1lVGFiID0gdHJ1ZTtcbiAgICB9XG5cbiAgICBpZihpc1NhbWVUYWIpIHtcbiAgICAgIGlmIChhQ2FuQ2xpY2spIHtcbiAgICAgICAgJChcIiNzaWduZWQtaW4tY29udGVudFwiKS5yZW1vdmVDbGFzcyhcImRpc2FibGVkLWNsaWNrXCIpO1xuICAgICAgICAkKFwiI3NpZ25lZC1pbi1jb250ZW50XCIpLmFkZENsYXNzKFwiZW5hYmxlZC1jbGlja1wiKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgICQoXCIjc2lnbmVkLWluLWNvbnRlbnRcIikucmVtb3ZlQ2xhc3MoXCJlbmFibGVkLWNsaWNrXCIpO1xuICAgICAgICAkKFwiI3NpZ25lZC1pbi1jb250ZW50XCIpLmFkZENsYXNzKFwiZGlzYWJsZWQtY2xpY2tcIik7XG4gICAgICB9XG4gICAgfVxuICB9LFxuICAvKipcbiAgICogRm9yIFdpbmRvd3MgYW5kIEZpcmVmb3gsIHRoZSBmb2N1cyBpcyBwbGFjZWQgaW4gPGE+IGVsZW1lbnRzIGluc3RlYWQgb2YgPGRpdj4gb3IgPHNwYW4+IGVsZW1lbnRzLiBUaGlzIGlzIHdoeSB3ZSBzZWFyY2ggZm9yXG4gICAqIDxkaXY+IGFuZCA8c3Bhbj4gZWxlbWVudHMgd2l0aCBwb3NpdGl2ZSB0YWJpbmRleCBhdHRyaWJ1dGVzLCBhbmQgbW92ZSB0aGUgdGFiaW5kZXggYXR0cmlidXRlIHRvIHRoZSBuZWFyZXN0IDxhPiBwYXJlbnQuXG4gICAqIEFsc28sIGluIHRoZSB1c2VyIG1lbnUsIHRoZSA8bGk+IGVsZW1lbnRzIGNvbnRhaW4gPGE+IGVsZW1lbnRzLiBXZSB3aWxsIGFsc28gbW92ZSB0aGUgdGFiaW5kZXggYXR0cmlidXRlIGZyb20gdGhlIDxsaT5cbiAgICogZWxlbWVudCB0byB0aGVpciA8YT4gY2hpbGQuXG4gICAqL1xuICBhZGp1c3RUYWJJbmRleCA6IGZ1bmN0aW9uKCkge1xuICAgIGlmIChcIldpbmRvd1wiID09IFV0aWxpdHlIZWxwZXIuZ2V0Q2xpZW50KCkub3MpIHtcbiAgICAgICQoJ2Rpdlt0YWJpbmRleF0sIHNwYW5bdGFiaW5kZXhdJykuZWFjaChmdW5jdGlvbihhSW5kZXgsIGFFbGVtZW50KSB7XG4gICAgICAgIHZhciBlbGVtZW50ID0gJChhRWxlbWVudCk7XG4gICAgICAgIGlmICgwIDw9IHBhcnNlSW50KGVsZW1lbnQuYXR0cihcInRhYmluZGV4XCIpKSkge1xuICAgICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cihcInRhYmluZGV4XCIpO1xuICAgICAgICAgIHZhciBwYXJlbnRzID0gZWxlbWVudC5wYXJlbnRzKFwiYVwiKTtcbiAgICAgICAgICBpZiAoMCA8IHBhcmVudHMubGVuZ3RoKSB7XG4gICAgICAgICAgICAkKHBhcmVudHNbMF0pLmF0dHIoXCJ0YWJpbmRleFwiLCBcIjBcIik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgJCgnI3VzZXItbWVudSBsaScpLmVhY2goZnVuY3Rpb24oYUluZGV4LCBhRWxlbWVudCkge1xuICAgICAgICB2YXIgZWxlbWVudCA9ICQoYUVsZW1lbnQpO1xuICAgICAgICBlbGVtZW50LnJlbW92ZUF0dHIoXCJ0YWJpbmRleFwiKTtcbiAgICAgICAgZWxlbWVudC5maW5kKFwiYVwiKS5hdHRyKFwidGFiaW5kZXhcIiwgMCk7XG4gICAgICB9KTtcbiAgICB9XG4gIH0sXG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIHRhYmluZGV4IGF0dHJpYnV0ZSBmb3IgQ2hyb21lIGFuZCBTYWZhcmkuXG4gICAqL1xuICByZW1vdmVUYWJJbmRleCA6IGZ1bmN0aW9uKCkge1xuICAgIGlmIChDb25maWdzLkJST1dTRVIgIT09IFwiZnhcIikge1xuICAgICAgJChcIiNtYWluLXdpbmRvdyAqXCIpLnJlbW92ZUF0dHIoXCJ0YWJpbmRleFwiKTtcbiAgICAgICQoXCIjbWFpbi13aW5kb3dcIikuYXR0cihcInRhYmluZGV4XCIsIFwiLTFcIik7XG4gICAgfVxuICB9LFxuXG4gIGdldEdBVGFiVHJhY2tpbmdOYW1lIDogZnVuY3Rpb24oYVRhYk5hbWUpIHtcbiAgICBzd2l0Y2goYVRhYk5hbWUpIHtcbiAgICAgIGNhc2UgXCJ0YWItd2F0Y2hpbmdcIjpcbiAgICAgICAgcmV0dXJuIFwiV2F0Y2hpbmdcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwidGFiLXNlbGxpbmdcIjpcbiAgICAgICAgcmV0dXJuIFwiU2VsbGluZ1wiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJ0YWItYnV5aW5nXCI6XG4gICAgICAgIHJldHVybiBcIkJ1eWluZ1wiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgXCJ0YWItbm90aWZpY2F0aW9uXCI6XG4gICAgICAgIHJldHVybiBcIk5vdGlmaWNhdGlvbnNcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwic2VhcmNoLXRhYi1yZWNlbnQtc2VhcmNoZXNcIjpcbiAgICAgICAgcmV0dXJuIFwiUmVjZW50U2VhcmNoZXNcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFwic2VhcmNoLXRhYi1mb2xsb3dlZC1zZWFyY2hlc1wiOlxuICAgICAgICByZXR1cm4gXCJGb2xsb3dlZFNlYXJjaGVzXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgcmV0dXJuIFwiTm90aWZpY2F0aW9uc1wiO1xuICAgIH1cbiAgfSxcblxuICBnZXRHQUxpc3RUeXBlVHJhY2tpbmdOYW1lIDogZnVuY3Rpb24oYUxpc3RUeXBlKSB7XG4gICAgc3dpdGNoKGFMaXN0VHlwZSkge1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLldBVENISU5HOlxuICAgICAgICByZXR1cm4gXCJXYXRjaGluZ1wiO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLlNFTExJTkc6XG4gICAgICAgIHJldHVybiBcIlNlbGxpbmdBY3RpdmVcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEl0ZW0uVFlQRVMuU0VMTElOR19PRkZFUjpcbiAgICAgICAgcmV0dXJuIFwiU2VsbGluZ09mZmVyc1wiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5TT0xEOlxuICAgICAgICByZXR1cm4gXCJTZWxsaW5nU29sZFwiO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgSXRlbS5UWVBFUy5VTlNPTEQ6XG4gICAgICAgIHJldHVybiBcIlNlbGxpbmdVbnNvbGRcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEl0ZW0uVFlQRVMuU0NIRURVTEVEOlxuICAgICAgICByZXR1cm4gXCJTZWxsaW5nU2NoZWR1bGVkXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLkJJRERJTkc6XG4gICAgICAgIHJldHVybiBcIkJ1eWluZ0JpZHNcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIEl0ZW0uVFlQRVMuQkVTVF9PRkZFUjpcbiAgICAgICAgcmV0dXJuIFwiQnV5aW5nQmVzdE9mZmVyXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLldPTjpcbiAgICAgICAgcmV0dXJuIFwiQnV5aW5nV29uXCI7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSBJdGVtLlRZUEVTLkxPU1Q6XG4gICAgICAgIHJldHVybiBcIkJ1eWluZ0xvc3RcIjtcbiAgICAgICAgYnJlYWs7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gXCJXYXRjaGluZ1wiO1xuICAgIH1cbiAgfSxcblxuICBvYnNlcnZlOiBmdW5jdGlvbihhVG9waWMsIGFEYXRhKSB7XG4gICAgc3dpdGNoIChhVG9waWMpIHtcbiAgICAgIGNhc2UgVG9waWNzLkFDQ09VTlRfU0lHTkVEX0lOOlxuICAgICAgICB0aGlzLl9zZXRTaWduSW5TdGF0ZShhRGF0YS5hY2NvdW50KTtcbiAgICAgICAgYnJlYWs7XG4gICAgICBjYXNlIFRvcGljcy5BQ0NPVU5UX1NJR05FRF9PVVQ6XG4gICAgICAgIHRoaXMuX3NldFNpZ25JblN0YXRlKG51bGwpO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgVG9waWNzLkNPTk5FQ1RJT05fT0ZGTElORTpcbiAgICAgIGNhc2UgVG9waWNzLkNPTk5FQ1RJT05fT05MSU5FOlxuICAgICAgICB0aGlzLnNldE9ubGluZVN0YXRlKCk7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxufTtcblxuJChkb2N1bWVudCkucmVhZHkoZnVuY3Rpb24oKSB7IFNpZGViYXIuaW5pdCgpOyB9KTtcbiQod2luZG93KS51bmxvYWQoZnVuY3Rpb24oKSB7IFNpZGViYXIudW5pbml0KCk7IH0pO1xuIl19